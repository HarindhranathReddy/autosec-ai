import pytest
import subprocess
import os

def test_exploitation():
    result = subprocess.run(['./modules/exploitation/exploit.sh', 'example.com', 'output'], capture_output=True, text=True)
    assert result.returncode == 0
    assert "Exploitation completed" in result.stdout

    # Check if expected output files are created
    expected_files = [
        'output/exploit_sqlmap',
        'output/exploit_xsstrike',
        'output/exploit_commix',
        'output/exploit_lfisuite.txt',
        'output/exploit_smuggler.txt',
        'output/exploit_race-the-web.txt'
    ]
    for file in expected_files:
        assert os.path.exists(file)